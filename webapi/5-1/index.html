<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.26" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/images/favicon.png" type="image/x-icon" />

    <title>5-1 Designing a Web API :: COMP312 labs</title>
    
    
    <link href="/css/nucleus.css?1504081602" rel="stylesheet">
    <link href="/css/font-awesome.min.css?1504081602" rel="stylesheet">
    <link href="/css/hybrid.css?1504081602" rel="stylesheet">
    <link href="/css/featherlight.min.css?1504081602" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1504081602" rel="stylesheet">
    <link href="/css/horsey.css?1504081602" rel="stylesheet">
    <link href="/css/theme.css?1504081602" rel="stylesheet">
    <link href="/css/hugo-theme.css?1504081602" rel="stylesheet">
    

    <script src="/js/jquery-2.x.min.js?1504081602"></script>
    
    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{ 
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/webapi/5-1/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://www.ipm.edu.mo/">
<b>COMP312 Internet Programming II</b>
</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fa fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fa fa-close"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1504081602"></script>
<script type="text/javascript" src="/js/horsey.js?1504081602"></script>
<script type="text/javascript">
    
        var baseurl = "http:\/\/philiplei.github.io\/";
    
</script>
<script type="text/javascript" src="/js/search.js?1504081602"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/webapi/" title="Webapis" class="dd-item 
        parent
        
        
        ">
      <a href="/webapi/">
          Webapis
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/webapi/5-1/" title="5-1 Designing a Web API" class="dd-item active">
        <a href="/webapi/5-1/">
        5-1 Designing a Web API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/webapi/5-2/" title="5-2 Implementing a Web API" class="dd-item ">
        <a href="/webapi/5-2/">
        5-2 Implementing a Web API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/webapi/5-3/" title="5-3 Consuming a Web API" class="dd-item ">
        <a href="/webapi/5-3/">
        5-3 Consuming a Web API
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/webapi/" title="Ajax and Web API" class="dd-item ">
        <a href="/webapi/">
        Ajax and Web API
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/server/" title="Servers" class="dd-item 
        
        
        
        ">
      <a href="/server/">
          Servers
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/server/4-1/" title="4-1 Node.js primer" class="dd-item ">
        <a href="/server/4-1/">
        4-1 Node.js primer
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-2/" title="4-2 NPM modules" class="dd-item ">
        <a href="/server/4-2/">
        4-2 NPM modules
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-3/" title="4-3 Web app routing" class="dd-item ">
        <a href="/server/4-3/">
        4-3 Web app routing
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-4/" title="4-4 Web app middlewares" class="dd-item ">
        <a href="/server/4-4/">
        4-4 Web app middlewares
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-5/" title="4-5 Templates and file modules" class="dd-item ">
        <a href="/server/4-5/">
        4-5 Templates and file modules
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-6/" title="4-6 Database access" class="dd-item ">
        <a href="/server/4-6/">
        4-6 Database access
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/4-7/" title="4-7 A sample web app" class="dd-item ">
        <a href="/server/4-7/">
        4-7 A sample web app
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/server/" title="Server-side programming" class="dd-item ">
        <a href="/server/">
        Server-side programming
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/client/" title="Clients" class="dd-item 
        
        
        
        ">
      <a href="/client/">
          Clients
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/client/3-1/" title="3-1 Quick start" class="dd-item ">
        <a href="/client/3-1/">
        3-1 Quick start
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-2/" title="3-2 Select and change" class="dd-item ">
        <a href="/client/3-2/">
        3-2 Select and change
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-3/" title="3-3 Creating new content" class="dd-item ">
        <a href="/client/3-3/">
        3-3 Creating new content
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-4/" title="3-4 Handling events" class="dd-item ">
        <a href="/client/3-4/">
        3-4 Handling events
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-5/" title="3-5 Form controls" class="dd-item ">
        <a href="/client/3-5/">
        3-5 Form controls
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-6/" title="3-6 Templates" class="dd-item ">
        <a href="/client/3-6/">
        3-6 Templates
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-7/" title="3-7 Charts" class="dd-item ">
        <a href="/client/3-7/">
        3-7 Charts
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/3-8/" title="3-8 Script execution in browsers" class="dd-item ">
        <a href="/client/3-8/">
        3-8 Script execution in browsers
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/client/" title="Client-side programming" class="dd-item ">
        <a href="/client/">
        Client-side programming
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/basic/" title="Basics" class="dd-item 
        
        
        
        ">
      <a href="/basic/">
          Basics
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/basic/2-1/" title="2-1 Basic data types and control" class="dd-item ">
        <a href="/basic/2-1/">
        2-1 Basic data types and control
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/2-2/" title="2-2 Arrays and functions" class="dd-item ">
        <a href="/basic/2-2/">
        2-2 Arrays and functions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/2-3/" title="2-3 Objects and JSON data" class="dd-item ">
        <a href="/basic/2-3/">
        2-3 Objects and JSON data
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/2-4/" title="2-4 Callbacks and arrow functions" class="dd-item ">
        <a href="/basic/2-4/">
        2-4 Callbacks and arrow functions
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/2-5/" title="2-5 Defining class" class="dd-item ">
        <a href="/basic/2-5/">
        2-5 Defining class
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/2-6/" title="2-6 Regular expression" class="dd-item ">
        <a href="/basic/2-6/">
        2-6 Regular expression
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/basic/" title="JavaScript basics" class="dd-item ">
        <a href="/basic/">
        JavaScript basics
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>

    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable sticky-parent">
              
              <div class="sticky-spacer">
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fa fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fa fa-list-alt"></i></span>
                  
                  <span class="links">
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/'>COMP312 labs</a> > <a href='/webapi/'>Webapis</a> > 5-1 Designing a Web API
          
         
          
         
          
           
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#rpc-style-web-api">RPC-style Web API</a>
<ul>
<li><a href="#read-only-operations">Read-only operations</a></li>
<li><a href="#update-operations">Update operations</a></li>
</ul></li>
<li><a href="#exercise">Exercise</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>5-1 Designing a Web API</h1>
          

        



<p>In an Ajax web app, the application server implements a Web API that provides service to the front-end JavaScript code.</p>

<p>A <dfn>Web API</dfn> is a defined set of HTTP request messages along with a definition of the structure of response messages, usually expressed in an XML or JSON format (from <a href="https://en.wikipedia.org/wiki/Web_API">Wikipedia</a>).</p>

<h2 id="rpc-style-web-api">RPC-style Web API</h2>

<p>A common design style of Web API is RPC-style (Remote Procedure Call). A RPC-style Web API allocates <em>one URL for each function or operation</em>.  These URLs represent an action and are usually named with a verb.  The following table shows the five endpoints in the Web API of our sample web app. They implement four common operations on data known as CRUD (Create, Retrieve, Update and Delete).</p>

<table>
<thead>
<tr>
<th>method</th>
<th>URL</th>
<th>function</th>
</tr>
</thead>

<tbody>
<tr>
<td>GET</td>
<td>/getTodo</td>
<td>List all tasks</td>
</tr>

<tr>
<td>GET</td>
<td>/searchTodo</td>
<td>Search tasks that are due before the given date.</td>
</tr>

<tr>
<td>POST</td>
<td>/addTodo</td>
<td>Add a new task</td>
</tr>

<tr>
<td>POST</td>
<td>/updateTodo</td>
<td>Update a task</td>
</tr>

<tr>
<td>POST</td>
<td>/deleteTodo</td>
<td>Delete a task</td>
</tr>
</tbody>
</table>

<p>Each endpoint is identified with the HTTP method (either GET or POST) and an URL.
An endpoint uses <strong>GET</strong> if the operation is <em>read-only</em>. If the operation may causes some action or side-effect on the server side, the endpoint must use <strong>POST</strong>.</p>

<p>In addition, when you design a Web API, you also need to specify:</p>

<ul>
<li>input parameters, whether they are urlencoded or json format, and whether to pass them in URL query or request message body</li>
<li>results, whether they are urlencoded or json format</li>
<li>error reporting</li>
</ul>

<h3 id="read-only-operations">Read-only operations</h3>

<p>A Web API may return result in either key-value pairs (www-url-encoded) or JSON.
Key-value pairs are only suitable for simple values. JSON is more flexible in representing data structure. Therefore, we&rsquo;ll use JSON payload as result in responses of Web API.</p>

<p>Sample request message to retrieve tasks:</p>

<pre><code class="language-HTTP">GET /getTodo HTTP/1.1
Host: example.com

</code></pre>

<p>Below is a sample response message returned by the Web API. The JSON payload has <code>Content-type: applicatin/json</code>. The <a href="http://www.json.org/">JSON data format</a> is mostly the same as JavaScript object syntax. But it can only contain simple values (namely numbers, strings and boolean) and all property names must be quoted.</p>

<pre><code class="language-HTTP">HTTP/1.1 200 Ok
Content-type: application/json
Content-length: 234

{
  &quot;count&quot;: 2,
  &quot;task&quot;: [     
    { &quot;id&quot;: 1, &quot;due&quot;: &quot;2016-11-11&quot;, &quot;what&quot;: &quot;Test&quot;,
      &quot;category&quot;: &quot;study&quot;, &quot;done&quot;: 0 },
    { &quot;id&quot;: 2, &quot;due&quot;: &quot;2016-12-13&quot;, &quot;what&quot;: &quot;Final exam&quot;,
      &quot;category&quot;: &quot;study&quot;, &quot;done&quot;: 0 }
  ]
}
</code></pre>

<p>A client may pass simple parameters to the Web API using <em>query</em>. This is similar to web search form submission. Below is a request for the endpoint <code>GET /searchTodo</code> to search tasks that are due before a given date. Note that HTTP GET requests <em>cannot</em> contain a body, so any data must be passed in the URL. We cannot use JSON format for input parameters to GET endpoints.</p>

<pre><code class="language-HTTP">GET /searchTodo?before=2016-12-01 HTTP/1.1
Host: example.com

</code></pre>

<p>Some designers use HTTP status codes like <code>400</code> and <code>500</code> to report runtime error. Other designers choose to use the JSON payload to report error. What is important is that you should be consistent.</p>

<pre><code class="language-HTTP">HTTP/1.1 400 Bad Request
Content-type: application/json
Content-length: 62

{ &quot;errorCode&quot;: 1001, &quot;message&quot;: &quot;Date format error in input&quot; }
</code></pre>

<pre><code class="language-HTTP">HTTP/1.1 500 Internal Server Error
Content-type: application/json
Content-length: 63

{ &quot;errorCode&quot;: 1002, &quot;message&quot;: &quot;Database connection problem&quot; }
</code></pre>

<pre><code class="language-HTTP">HTTP/1.1 200 Ok
Content-type: application/json
Content-length: 63

{ &quot;errorCode&quot;: 1002, &quot;message&quot;: &quot;Database connection problem&quot; }
</code></pre>

<h3 id="update-operations">Update operations</h3>

<p>The endpoints of any update operations <strong>must use POST</strong>. It informs that any web proxy servers between the client and the Web API should not cache responses of the operations. In update operations, there are usually some input parameters. You can pass simple parameters as key-value pairs (i.e. <code>www-form-urlencoded</code>) in the request message body.</p>

<p>Below is a sample request for adding a task in the Web API.</p>

<pre><code class="language-HTTP">POST /addTodo HTTP/1.1
Host: example.com
Content-type: application/x-www-form-urlencoded
Content-length: 53

due=2017-01-06&amp;what=Makeup+exam&amp;category=study&amp;done=0
</code></pre>

<p>For more complicated data, use JSON data format.</p>

<pre><code class="language-HTTP">POST /addTodo HTTP/1.1
Host: example.com
Content-type: application/json
Content-length: 80

{ &quot;due&quot;: &quot;2017-01-06&quot;, &quot;what&quot;: &quot;Makeup exam&quot;,
  &quot;category&quot;: &quot;study&quot;, &quot;done&quot;: 0 }
</code></pre>

<p>Urlencoded payload is usually preferred for Web APIs in an Ajax web app. First, the input parameters are usually simple. Furthermore, it is easier to work with
key-value pairs in client-side programming (e.g. using jQuery).</p>

<p>A <em>successful response</em> from an update operation may provide some info about the update operation, e.g. the id of the newly created record.</p>

<pre><code class="language-HTTP">HTTP/1.1 200 Ok
Content-type: application/json
Content-length: 11

{ &quot;id&quot;:21 }
</code></pre>

<p>For the delete operation, the client must specify the <code>id</code> of the task to delete.</p>

<pre><code class="language-HTTP">POST /deleteTodo HTTP/1.1
Host: example.com
Content-type: application/x-www-form-urlencoded
Content-length: 4

id=3
</code></pre>

<p>A <em>successful</em> response for the delete operation may have empty body. In this case, use HTTP status code <code>204</code> instead of <code>200</code>.</p>

<pre><code class="language-HTTP">HTTP/1.1 204 No content

</code></pre>

<p>In the updateTodo operation, the client must specify the <code>id</code> of the task to change, and then list the properties and their new values.</p>

<pre><code class="language-HTTP">POST /updateTodo HTTP/1.1
Host: example.com
Content-type: application/x-www-form-urlencoded
Content-length: 53

id=21&amp;what=Makeup+exam+COMP312
</code></pre>

<h2 id="exercise">Exercise</h2>

<ol>
<li><p>Write sample response messages for the <code>POST /updateTodo</code> endpoint for successful update, and unsuccessful update because the record with the given id does not exist.</p></li>

<li><p>Design a new endpoint <code>GET /getTodoWithId</code>, to retrieve a task with a given <code>id</code>. Write sample response messages for successful and unsuccessful retrieval.</p></li>

<li><p>Design a new endpoint for the Web API for the operation of marking a task as done (i.e. set the done property to 1 in the server database.) Write sample response messages for successful and unsuccessful operation. In your answer, describe what input parameters are required.</p></li>
</ol>


<footer class=" footline" >
	
</footer>


        
        </div> 
      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


        
            <a class="nav nav-prev" href="/webapi/5-3/" title="5-3 Consuming a Web API"> <i class="fa fa-chevron-left"></i></a>
        
        
            <a class="nav nav-next" href="/server/" title="Servers" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
        
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1504081602"></script>
    <script src="/js/perfect-scrollbar.min.js?1504081602"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1504081602"></script>
    <script src="/js/jquery.sticky-kit.min.js?1504081602"></script>
    <script src="/js/featherlight.min.js?1504081602"></script>
    <script src="/js/html5shiv-printshiv.min.js?1504081602"></script>
    <script src="/js/highlight.pack.js?1504081602"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js?1504081602"></script>
    <script src="/js/learn.js?1504081602"></script>
    <script src="/js/hugo-learn.js?1504081602"></script>

    <link href="/mermaid/mermaid.css?1504081602" type="text/css" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1504081602"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

