<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Hugo 0.17-DEV" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon" />

    
    <title>2-4 Callbacks and arrow functions</title>
    <link href="/css/nucleus.css" rel="stylesheet">
    <link href="/css/font-awesome.min.css" rel="stylesheet">
    <link href="/css/hybrid.css" rel="stylesheet">
    <link href="/css/featherlight.min.css" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css" rel="stylesheet">
    <link href="/css/theme.css" rel="stylesheet">
    <link href="/css/hugo-theme.css" rel="stylesheet">
    <style type="text/css">:root #header + #content > #left > #rlblock_left
    {display:none !important;}</style>
    

  </head>
  <body class="" data-url="/basic/2-4/">
    <nav id="sidebar">
  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="http://www.ipm.edu.mo/">
<b>COMP312 Internet Programming II</b>
</a>

      
    </div>
</div>


  <div class="highlightable">
    <ul class="topics">
      
      
      
      

      <li class="dd-item  parent" data-nav-id="/basic/">
        <a href="/basic/">
          <span>
            
              <b>2. </b>
            
             JavaScript basics
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/basic/2-1/">
              <a href="/basic/2-1/">
                <span>2-1 Basic data types and control     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/basic/2-2/">
              <a href="/basic/2-2/">
                <span>2-2 Arrays and functions     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/basic/2-3/">
              <a href="/basic/2-3/">
                <span>2-3 Objects and JSON data     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item active" data-nav-id="/basic/2-4/">
              <a href="/basic/2-4/">
                <span>2-4 Callbacks and arrow functions     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/basic/2-5/">
              <a href="/basic/2-5/">
                <span>2-5 Defining class     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/basic/2-6/">
              <a href="/basic/2-6/">
                <span>2-6 Regular expression     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      
      

      <li class="dd-item  " data-nav-id="/client/">
        <a href="/client/">
          <span>
            
              <b>3. </b>
            
             Client-side programming
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/client/3-1/">
              <a href="/client/3-1/">
                <span>3-1 Quick start     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-2/">
              <a href="/client/3-2/">
                <span>3-2 Select and change     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-3/">
              <a href="/client/3-3/">
                <span>3-3 Creating new content     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-4/">
              <a href="/client/3-4/">
                <span>3-4 Handling events     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-5/">
              <a href="/client/3-5/">
                <span>3-5 Form controls     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-6/">
              <a href="/client/3-6/">
                <span>3-6 Templates     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-7/">
              <a href="/client/3-7/">
                <span>3-7 Charts     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/client/3-8/">
              <a href="/client/3-8/">
                <span>3-8 Script execution in browsers     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
      
      

      <li class="dd-item  " data-nav-id="/server/">
        <a href="/server/">
          <span>
            
              <b>4. </b>
            
             Server-side programming
            
           </span>
        </a>
        
        <ul>
          
          
          
          
            <li class="dd-item " data-nav-id="/server/4-1/">
              <a href="/server/4-1/">
                <span>4-1 Node.js primer     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-2/">
              <a href="/server/4-2/">
                <span>4-2 NPM modules     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-3/">
              <a href="/server/4-3/">
                <span>4-3 Web app routing     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-4/">
              <a href="/server/4-4/">
                <span>4-4 Web app middlewares     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-5/">
              <a href="/server/4-5/">
                <span>4-5 Templates and file modules     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-6/">
              <a href="/server/4-6/">
                <span>4-6 Database access     </i></span>
              </a>
            </li>
          
          
          
            <li class="dd-item " data-nav-id="/server/4-7/">
              <a href="/server/4-7/">
                <span>4-7 A sample web app     </i></span>
              </a>
            </li>
          
          
        </ul>
        
      </li>
      
      
    </ul>
    <hr>
      
    <section id="footer">
      <p>Built with <a href="https://github.com/matcornic/hugo-theme-learn"><i class="fa fa-heart"></i></a> from <a href="http://getgrav.org">Grav</a> and <a href="http://gohugo.io/">Hugo</a></p>
    </section>
  </div>
</nav>

        <section id="body">
        <div id="overlay"></div>

        <div class="padding highlightable">

            <div id="top-bar">
              
              <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                  <span id="sidebar-toggle-span">
                      <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                        <i class="fa fa-bars"></i>
                      </a>
                  </span>
                
                <span id="toc-menu"><a href=""><i class="fa fa-list-alt"></i></a></span>
                
                
                
                
                  
                    
                    
                <a href="/basic/" itemprop="url"><span itemprop="title">JavaScript basics</span></a> <i class="fa fa-angle-right"></i>
                    
                  
                
                  
                
                  
                
                <span itemprop="title"> 2-4 Callbacks and arrow functions</span>
              </div>
              
                  <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
<ul>
<li>
<ul>
<li><a href="#functions-as-first-class-values">Functions as first-class values</a></li>
<li><a href="#map-and-filter">Map and filter</a></li>
<li><a href="#sorting">Sorting</a></li>
<li><a href="#timer">Timer</a></li>
<li><a href="#arrow-functions">Arrow functions</a></li>
<li><a href="#excersie">Excersie</a></li>
</ul></li>
</ul>
</nav>
    </div>
</div>

              

            </div>
            
    	        <div id="body-inner">
                
                <h1>2-4 Callbacks and arrow functions</h1>
                



<h2 id="functions-as-first-class-values">Functions as first-class values</h2>

<p>Functions in JavaScript are often described as first-class values. (In fact, functions are objects, with their own properties and methods.) This means that, in many cases, if you can do something on numbers or strings, you can also do the same on functions. In particular,
you can save a function in a variable, pass a function to another function, or return a function from a function.</p>

<pre><code class="language-JavaScript">function add (a,b) { return a+b; }
var f = add;
f(1,2); // returns 3;
add(1,2); // same
// dir(f)
</code></pre>

<p>Passing a function to another function is possible. This is an example of <dfn>callback</dfn>, and can change the behavior of another function.</p>

<pre><code class="language-JavaScript">// use a function op(x,y) to combine 3 values
function combine (op, a, b, c) {
  var t = op(a,b);
  var ans = op(t,c);
  return ans;
}

// define an anonymous function, and save it in the variable 'add'
var add = function(a,b) { return a+b; }
combine(add, 6, 7, 8); // returns 21

var mul = function(a,b) { return a*b; }
combine(mul, 6, 7, 8); // returns 336
</code></pre>

<h2 id="map-and-filter">Map and filter</h2>

<p>A common case in processing a large amount of data in arrays is to iterate the elements and perform some processing or filtering on each element.</p>

<pre><code class="language-JavaScript">var a = [1/2, 1/3, 1/4, 1/5, 1/6];
var b = [];
// round the numbers to 2 decimal places
for (var n of a) {
  var n2 = Math.round(n*100) / 100;
  b.push(n2);
}
// print a and b
</code></pre>

<pre><code class="language-JavaScript">// an array of objects, each one is a rectangle with given width and height
var c = [ { w: 4, h: 5 }, { w: 2, h: 3 } ];
var d = [];
// calculate the area of the rectangles
for (var k=0; k&lt;c.length; k++) {
  var area = c[k].w * c[k].h;
  d.push(area);
}
// print c and d
</code></pre>

<p>This is a common scenario in programming. Therefore, the JavaScript Array objects provide built-in methods to iterate their content. One of the simplest is <code>.map()</code>, which accepts a function as parameter. The function takes 1 input, perform some processing, and returns the result. <code>.map()</code> collects these results into an output array.</p>

<pre><code class="language-JavaScript">function round2(n) { return Math.round(n*100) / 100; }

var a = [1/2, 1/3, 1/4, 1/5, 1/6];
var b = a.map(round2);
</code></pre>

<p>The function <code>round2</code> is another example of <dfn>callback</dfn> function. This callback function is not called directly by your code. Instead, after definition, you pass the callback function to someone else&rsquo;s code, and their code will call back your function later.</p>

<p>If this function is not used anywhere else, you can define it in the parameter list of <code>.map()</code>.</p>

<pre><code class="language-JavaScript">var a = [1/2, 1/3, 1/4, 1/5, 1/6];
var b = a.map(function round2(n) {
   return Math.round(n*100) / 100;
});
</code></pre>

<p>And you can even omit the function name. This defines an <dfn>anonymous function</dfn>.</p>

<pre><code class="language-JavaScript">var a = [1/2, 1/3, 1/4, 1/5, 1/6];
var b = a.map(function(n) {
   return Math.round(n*100) / 100;
});
</code></pre>

<p>Another way to look at this is that a callback function can customize / modify the functionality of an existing function. For example, to calculate areas of rectangles in an array, we can write another callback function and pass it to <code>.map()</code>.</p>

<pre><code class="language-JavaScript">// an array of objects, each one is a rectangle with given width and height
var c = [ { w: 4, h: 5 }, { w: 2, h: 3 } ];
var d = c.map(function (r) {
  return r.w * r.h;
});
</code></pre>

<p>In addition to <code>.map()</code>, another popular iteration function in Array is <code>.filter()</code>.</p>

<pre><code class="language-JavaScript">var e = ['joy', 'sadness', 'anger', 'disgust', 'fear'];
var f = [];
for (var s of e) {
  if (s.length&lt;5) f.push(s);
}
// print e and f

// same as the for loop above
f = e.filter(function(s) { return (s.length&lt;5); });
</code></pre>

<h2 id="sorting">Sorting</h2>

<p>JavaScript arrays have a built-in <code>sort</code> method. It can sort numbers and strings, but it does not know how to sort other objects.</p>

<pre><code class="language-JavaScript">var a = [5, 4, 1, 2, 3];
a.sort();  // a becomes [1,2,3,4,5]
var b = ['apple', 'orange', 'banana'];
b.sort(); // b becomes ['apple', 'banana', 'orange']

var p = [
  { name: 'Peter', age: 10 }, { name: 'Mary', age: 9 },
  { name: 'John', age: 11 } ];
p.sort(); // sort by name? by age?
</code></pre>

<p>You can teach <code>.sort()</code> how to compare two objects with a callback function.</p>

<pre><code class="language-JavaScript">var p = [
  { name: 'Peter', age: 10 }, { name: 'Mary', age: 9 },
  { name: 'John', age: 11 } ];

// compare two persons by age
function cmp (p1, p2) {
  if (p1.age&lt;p2.age) return -1;  // p1 should be put before p2
  if (p1.age==p2.age) return 0;  // order not important
  return 1;                      // p1 should be put after p2
}

// sort by age
p.sort(cmp);
</code></pre>

<h2 id="timer">Timer</h2>

<p>Both browsers and Node.js support timers. Timers allow schedule of execution of a function in the future. There are two kinds of timers: one time (<code>setTimeout()</code>), and periodic (<code>setInterval()</code>). In either case, you pass the function to execute as a callback. Refer to the <a href="https://developer.mozilla.org/en-US/Add-ons/Code_snippets/Timers">online reference</a> for detail.</p>

<pre><code class="language-JavaScript">// say 'hello' every 3 seconds
var id = setInterval(function() { console.log('hello');}, 3000);

// cancel the timer
//clearInterval(id)
</code></pre>

<p>The following is a countdown example.</p>

<pre><code class="language-JavaScript">var n = 10;
function tick() {
  console.log('count down ', n);
  n--;
  // if not down to 0, schedule myself to run 1s later
  if (n&gt;0) { setTimeout(tick, 1000); }
}
// tick, the first time!
tick();
</code></pre>

<h2 id="arrow-functions">Arrow functions</h2>

<p>Anonymous functions are very common in JavaScript programming because of the asynchronous nature of client-side or server-side programming. (E.g. register a callback to handle mouse click). Therefore, ES6 defines a more concise syntax called <dfn>arrow functions</dfn> to define anonymous function. Usually, arrow functions are defined and passed directly to another function.</p>

<p>Compare the two ways to write functions below.</p>

<pre><code class="language-JavaScript">var f1 = (a,b) =&gt; { return a+b; };
var f2 = function (a,b) { return a+b; }

setTimeout(function() { console.log('hello');}, 2000);
setTimeout( () =&gt; { console.log('hello');}, 2000 );
</code></pre>

<p>Although we&rsquo;ll mainly use arrow functions in the same way as functions defined with <code>function</code> keyword, there are in fact some technical differences. One important difference is about the <code>this</code> pointer. Please refer to the <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Arrow_functions">online reference</a> for detail.</p>

<p>Array functions also provide some shorthand notation when the function body only returns an expression.</p>

<pre><code class="language-JavaScript">var f1 = (a,b) =&gt; a+b;  // same as below
var f2 = (a,b) =&gt; { return a+b; }

var f3 = a =&gt; a+1; // same as below
var f4 = (a) =&gt; { return a+1; }
</code></pre>

<p>Here are more examples to demonstrate the usage of arrow functions.</p>

<pre><code class="language-JavaScript">var a = [1/2, 1/3, 1/4, 1/5, 1/6];
var b = a.map(n =&gt; Math.round(n*100) / 100);

var c = [3, 5, 2, 1];
c.sort((a,b)=&gt;b-a); // sort in descending order

var e = ['joy', 'sadness', 'anger', 'disgust', 'fear'];
f = e.filter(s =&gt; s.length&lt;5);
</code></pre>

<h2 id="excersie">Excersie</h2>

<ol>
<li><p>Given an array <code>var N = [ 32, 53, 42, 25, 48, 10 ]</code>, write a program to do the following. You should use callback functions. <a href="/chap2/p211.js">(sample answer)</a></p>

<ul>
<li>Obtain an array of hexadecimal representation of the numbers in <code>N</code>. (Hints: use <code>n.toString(16)</code> to convert a number <code>n</code> to hexadecimal)</li>
<li>Obtain an array of the numbers in <code>N</code> between 20 and 40 inclusively</li>
<li>Count how many of the numbers  in <code>N</code> are odd</li>
<li>Calculate the sum of the numbers in <code>N</code>. Try to use <code>.reduce()</code> in Array. <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce">(online reference)</a></li>
</ul></li>

<li><p>The variable <code>comp312</code> is an array that contains records of student marks in the comp312 class. Each student record has three fields: name, test and exam. Write programs to do the following. Use an Array iteration method (i.e. <code>.map()</code>, <code>.filter()</code>, <code>.reduce()</code>, etc) at least once in each case. <a href="/chap2/p212.js">(sample answer)</a></p>

<pre><code class="language-JavaScript">var comp312 = [
  { name: 'Peter', test: 80, exam: 70 },
  { name: 'John', test: 60, exam: 65 },
  { name: 'Mary', test: 90, exam: 85 },
  { name: 'Christine', test: 70, exam: 76 }
];
</code></pre>

<ul>
<li>Get a list of student names in the comp312 class</li>
<li>Get a list of student record with test mark &gt;= 75</li>
<li>Get a list of student name whose test mark is greater than exam mark</li>
<li>Assume final mark = 0.6 * test + 0.4 * exam. Make an array with records showing the final mark and name for each student.</li>
<li>Sort the list in descending order of exam mark</li>
<li>Show the student record with the highest exam mark</li>
<li>Calculate the average test mark</li>
</ul></li>
</ol>


      
      </div>
    </div>

    <div id="navigation">
        
        
    </div>

    </section>
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/jquery-2.x.min.js"></script>
    <script src="/js/clipboard.min.js"></script>
    <script src="/js/perfect-scrollbar.min.js"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="/js/jquery.sticky-kit.min.js"></script>
    <script src="/js/featherlight.min.js"></script>
    <script src="/js/html5shiv-printshiv.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom.71422.js"></script>
    <script src="/js/learn.js"></script>
    <script src="/js/hugo-learn.js"></script>
    

  </body>
</html>

